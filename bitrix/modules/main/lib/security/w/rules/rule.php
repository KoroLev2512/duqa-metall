<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1739081689']= array(base64_decode('a'.'XNfc3RyaW5n'),base64_decode(''.'c3'.'RydG'.'9sb3'.'dlcg'.'='.'='),base64_decode('aXNfY'.'XJy'.'YXk='),base64_decode(''.'aXNfc3Rya'.'W5n'),base64_decode('Z3'.'pkZ'.'WNvZG'.'U='),base64_decode('YmFzZTY0X2RlY'.'29kZQ='.'='),base64_decode('dXJsZGVjb2Rl'),base64_decode('YXJyYXlfcmV'.'2ZXJzZQ='.'='),base64_decode('Z3pl'.'bmNvZGU='),base64_decode('YmFzZTY0X2'.'VuY'.'29kZQ=='),base64_decode('dXJsZW5j'.'b2R'.'l'),base64_decode(''.'Yml'.'uMmhl'.'eA=='),base64_decode('aXNfYXJ'.'yYXk='),base64_decode('c3'.'RydG9s'.'b3dlcg'.'=='),base64_decode(''.'aX'.'NfYXJy'.'YXk='),base64_decode(''.'am'.'9pbg='.'='),base64_decode('Zm5tYXRj'.'aA'.'=='),base64_decode('cmF3dXJsZGVjb2Rl'),base64_decode('c3Vic3R'.'y'),base64_decode('c3Vic3Ry'),base64_decode(''.'c3RyX3JlcGxhY2U='),base64_decode('cHJlZ'.'19xdW90'.'ZQ=='),base64_decode('c'.'HJlZ'.'19tYXRja'.'A=='));if(!function_exists(__NAMESPACE__.'\\___1359944104')){function ___1359944104($_1367615726){static $_1247080934= false; if($_1247080934 == false) $_1247080934=array(''.'YW'.'N0aW9'.'u','aW50dm'.'Fs','cGF0aA='.'=','Y29ud'.'GV4'.'dA'.'==',''.'a2V5c'.'w==','cH'.'JvY2Vzcw==','ZW5'.'jb2R'.'pb'.'mc=',''.'cHJ'.'lZ19yZX'.'BsYWNl','cGF0aA==','Y29ud'.'GV4'.'dA='.'=','a2V5cw='.'=','cH'.'JvY2'.'Vzcw==','ZW5jb2Rp'.'bmc=','cGF0dGV'.'yb'.'g'.'='.'=',''.'cHJlZ19tYXRjaA'.'='.'=','cGF0aA==','Y'.'29udGV4dA='.'=',''.'a2V'.'5'.'cw'.'==','cH'.'J'.'vY2'.'V'.'z'.'cw'.'='.'=',''.'ZW5jb'.'2R'.'pbmc'.'=','cG'.'F0d'.'G'.'Vybg==',''.'cG9zd'.'F9hY3Rpb2'.'4=','Y'.'2hlY2'.'t'.'fY3NyZg==','cGF0aA==','Y29'.'ud'.'GV4dA==','a'.'2V5c'.'w==','cHJvY2Vzcw'.'==','ZW5jb2R'.'p'.'bmc=','cGF0dG'.'Vybg'.'==',''.'YWN0aW9u','YWN0aW9u','Y'.'WN0'.'a'.'W9u','YWN0aW9u','YWN0aW9u','YWN0aW9u','cG'.'9zdF9'.'hY'.'3Rpb2'.'4'.'=',''.'Z'.'W5jb2Rpbm'.'c'.'=',''.'ZW5jb2Rpbmc=','ZW5j'.'b2'.'Rpb'.'mc'.'=','ZW5'.'jb2Rpbmc'.'=','ZW5jb2'.'Rpbm'.'c=',''.'ZW5j'.'b'.'2'.'Rpbmc=','Z3o=','Y'.'mF'.'zZ'.'TY0','dXJs','aGV4','Lg==','Lw='.'=',''.'aW'.'5'.'kZXgucGhw','L2l'.'uZGV4Ln'.'BocA==','U0NSSVB'.'U'.'X05B'.'TUU=','L2luZGV'.'4Ln'.'BocA='.'=',''.'U0NSSV'.'BUX05BTUU=',''.'U0NSSVBUX05B'.'TU'.'U'.'=','U0NSSVB'.'UX0'.'5'.'BTUU=','fg==','fl4=','f'.'g='.'=','XH'.'4=','JH'.'4=');return base64_decode($_1247080934[$_1367615726]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_481903737; protected $_1622965718; protected $_596854328; protected $_135484863; protected $_1952085657; public static function make(array $_607855671):?static{ $_607855671= static::prepareRuleParameters($_607855671); return match($_607855671[___1359944104(0)]){ ___1359944104(1) => new IntvalRule( $_607855671[___1359944104(2)], $_607855671[___1359944104(3)], $_607855671[___1359944104(4)], $_607855671[___1359944104(5)], $_607855671[___1359944104(6)]), ___1359944104(7) => new PregReplaceRule( $_607855671[___1359944104(8)], $_607855671[___1359944104(9)], $_607855671[___1359944104(10)], $_607855671[___1359944104(11)], $_607855671[___1359944104(12)], $_607855671[___1359944104(13)]), ___1359944104(14) => new PregMatchRule( $_607855671[___1359944104(15)], $_607855671[___1359944104(16)], $_607855671[___1359944104(17)], $_607855671[___1359944104(18)], $_607855671[___1359944104(19)], $_607855671[___1359944104(20)], $_607855671[___1359944104(21)]), ___1359944104(22) => new CsrfRule( $_607855671[___1359944104(23)], $_607855671[___1359944104(24)], $_607855671[___1359944104(25)], $_607855671[___1359944104(26)], $_607855671[___1359944104(27)], $_607855671[___1359944104(28)],), default => null,};} protected static function prepareRuleParameters(array $_647709865): array{ if($GLOBALS['____1739081689'][0]($_647709865[___1359944104(29)])){ $_647709865[___1359944104(30)]= $GLOBALS['____1739081689'][1]($_647709865[___1359944104(31)]);} elseif($GLOBALS['____1739081689'][2]($_647709865[___1359944104(32)])){ $_1713373967= $_647709865[___1359944104(33)]; $_647709865[___1359944104(34)]= $_1713373967[(168*2-336)]; $_647709865[___1359944104(35)]= $_1713373967[round(0+1)];} $_647709865[___1359944104(36)]=!empty($_647709865[___1359944104(37)])? $_647709865[___1359944104(38)]:[]; if($GLOBALS['____1739081689'][3]($_647709865[___1359944104(39)])){ $_647709865[___1359944104(40)]=[$_647709865[___1359944104(41)]];} return $_647709865;}  public function __construct($_481903737, $_1622965718, $_596854328, $_135484863, $_1952085657){ $this->_481903737= $_481903737; $this->_1622965718= $this->castContext($_1622965718); $this->_596854328= $this->castKeys($_596854328); $this->_135484863= $_135484863; $this->_1952085657= $_1952085657;} public function evaluateValue($_1687172790){ if(!empty($this->_1952085657)){ foreach($this->_1952085657 as $_1428281552){ $_1687172790= match($_1428281552){ 'gz' => $GLOBALS['____1739081689'][4]($_1687172790), 'base64' => $GLOBALS['____1739081689'][5]($_1687172790), 'url' => $GLOBALS['____1739081689'][6]($_1687172790), 'hex' => hex2bin($_1687172790)};}} $_1335352634= $this->evaluate($_1687172790); if(!empty($this->_1952085657) && $_1335352634 instanceof ModifyResult){ $_544155835= $_1335352634->getCleanValue(); foreach($GLOBALS['____1739081689'][7]($this->_1952085657) as $_1428281552){ $_544155835= match($_1428281552){ ___1359944104(42) => $GLOBALS['____1739081689'][8]($_544155835), ___1359944104(43) => $GLOBALS['____1739081689'][9]($_544155835), ___1359944104(44) => $GLOBALS['____1739081689'][10]($_544155835), ___1359944104(45) => $GLOBALS['____1739081689'][11]($_544155835)};} $_1335352634= new ModifyResult($_544155835);} return $_1335352634;} abstract public function evaluate($_1687172790); protected function castContext($_1622965718){ if(!$GLOBALS['____1739081689'][12]($_1622965718)){ $_1622965718=[$_1622965718];} foreach($_1622965718 as $_1373431240 => $_2061309433){ $_1622965718[$_1373431240]= $GLOBALS['____1739081689'][13]($_2061309433);} return $_1622965718;} protected function castKeys($_596854328){ if(!$GLOBALS['____1739081689'][14]($_596854328)){ $_596854328=[$_596854328];} return $_596854328;} public function matchKey(array $_1246895359): bool{ $_1246895359= $GLOBALS['____1739081689'][15](___1359944104(46), $_1246895359); foreach($this->_596854328 as $_518100527){   if($GLOBALS['____1739081689'][16]($_518100527, $_1246895359)){ return true;}} return false;}  public function matchPath($_114293690){ if($this->_481903737 === '*'){ return true;}  $_96003315= new Uri($_114293690); $_1157965069= $_96003315->getPath(); $_1157965069= $GLOBALS['____1739081689'][17]($_1157965069);      if(str_ends_with($_1157965069, ___1359944104(47))){ $_1157965069 .= ___1359944104(48);} $_1157965069= Path::normalize($_1157965069);  $_1236743264[]= $_1157965069; if(str_ends_with($_1157965069, ___1359944104(49))){ $_1236743264[]= $GLOBALS['____1739081689'][18]($_1157965069,(207*2-414),-round(0+2.25+2.25+2.25+2.25));} elseif(str_ends_with($_SERVER[___1359944104(50)], ___1359944104(51))){ $_1236743264[]= $GLOBALS['____1739081689'][19]($_SERVER[___1359944104(52)], min(70,0,23.333333333333),-round(0+3+3+3));} if($_1157965069 !== $_SERVER[___1359944104(53)]){ $_1236743264[]= $_SERVER[___1359944104(54)];}  if(str_starts_with($this->_481903737, ___1359944104(55))){ $_1565294058= $this->_481903737;} else{ $_1565294058= ___1359944104(56). $GLOBALS['____1739081689'][20](___1359944104(57), ___1359944104(58), $GLOBALS['____1739081689'][21]($this->_481903737)). ___1359944104(59);} foreach($_1236743264 as $_1672823365){ if($this->_481903737 === $_1672823365 || $GLOBALS['____1739081689'][22]($_1565294058, $_1672823365)){ return true;}} return false;}  public function getPath(){ return $this->_481903737;}  public function getContext(){ return $this->_1622965718;}  public function getKeys(){ return $this->_596854328;}  public function getProcess(){ return $this->_135484863;}}?>